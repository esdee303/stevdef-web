function resize(){initCanvas(canvasW=document.getElementById("canvas-container").offsetWidth+40,window.innerHeight);for(var e=0;e<verNum;e++)vertexes[e]=new Vertex(1960/(verNum-1)*e,118.5,118.5);initDiffPt();window.innerWidth}function init(){resize();setInterval(update,33);window.addEventListener&&addListener(window,"DOMMouseScroll",wheelHandler),addListener(window,"mousewheel",wheelHandler),addListener(window,"resize",resize),canvas.onmousedown=function(e){var t,i;e?(t=e.pageX,i=e.pageY):(t=event.x+document.body.scrollLeft,i=event.y+document.body.scrollTop),window.innerHeight/6-i<5&&window.innerHeight/6-i>-25&&(autoDiff=1e3,t<canvas.width-2&&(xx=1+Math.floor((verNum-2)*t/canvas.width),diffPt[xx]=autoDiff))}}function initDiffPt(){for(var e=0;e<verNum;e++)diffPt[e]=0}function update(){ctx.clearRect(0,0,canvas.width,237),autoDiff-=.9*autoDiff,diffPt[xx]=autoDiff;for(var e=xx-1;e>0;e--){(t=xx-e)>dd&&(t=dd),diffPt[e]-=(diffPt[e]-diffPt[e+1])*(1-.01*t)}for(e=xx+1;e<verNum;e++){var t;(t=e-xx)>dd&&(t=dd),diffPt[e]-=(diffPt[e]-diffPt[e-1])*(1-.01*t)}for(e=0;e<vertexes.length;e++)vertexes[e].updateY(diffPt[e]);draw()}function draw(){ctx.beginPath(),ctx.moveTo(0,window.innerHeight),ctx.fillStyle=color1,ctx.lineTo(vertexes[0].x,vertexes[0].y);for(var e=1;e<vertexes.length;e++)ctx.lineTo(vertexes[e].x,vertexes[e].y);ctx.lineTo(canvas.width,window.innerHeight),ctx.lineTo(0,window.innerHeight),ctx.fill(),ctx.beginPath(),ctx.moveTo(0,window.innerHeight),ctx.fillStyle=color2,ctx.lineTo(vertexes[0].x+15,vertexes[0].y+5);for(e=1;e<vertexes.length;e++)ctx.lineTo(vertexes[e].x+15,vertexes[e].y+5);ctx.lineTo(canvas.width,window.innerHeight),ctx.lineTo(0,window.innerHeight),ctx.fill(),ctx.fillStyle="#fff",ctx.font="12px",ctx.textBaseline="top",ctx.fillText("Click on the surface of the liquid",70,128.5),ctx.fillStyle="#fff",ctx.fillText("Mouse wheel to change the viscosity",70,143.5),ctx.fillText("Viscosity: "+(20*(dd-15)/7).toFixed(2)+"%",70,218.5)}function initCanvas(e,t){(canvas=document.getElementById("canvas-water")).width=1960,canvas.height=237,ctx=canvas.getContext("2d")}function Vertex(e,t,i){this.baseY=i,this.x=e,this.y=t,this.vy=0,this.targetY=0,this.friction=.15,this.deceleration=.95}var canvas,ctx,vertexes=[],diffPt=[],autoDiff=1e3,verNum=250,canvasW=window.innerWidth+40,addListener=function(e,t,i){e.addEventListener?e.addEventListener(t,i,!1):e.attachEvent&&e.attachEvent("on"+t,i)};addListener(window,"load",init);var wheelHandler=function(e){(e.detail?-e.detail:e.wheelDelta)>0?dd>15?dd--:dd=dd:dd<50?dd++:dd=dd},xx=150,dd=15,color1="#6ca0f6",color2="#367aec";Vertex.prototype.updateY=function(e){this.targetY=e+this.baseY,this.vy+=this.targetY-this.y,this.y+=this.vy*this.friction,this.vy*=this.deceleration};var blue=function(){color1="#6ca0f6",color2="#367aec"},black=function(){color1="#595959",color2="#000000"},purple=function(){color1="#ff92ec",color2="#f727d2"};